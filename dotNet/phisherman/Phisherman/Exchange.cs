using System;
using System.Net;
using System.Net.Security;
using System.Security.Cryptography.X509Certificates;
using Microsoft.Exchange.WebServices.Data;

namespace Phisherman
{
	// Token: 0x02000004 RID: 4
	internal class Exchange
	{
		// Token: 0x06000007 RID: 7 RVA: 0x00002280 File Offset: 0x00000480
		public static ExchangeService GetExchangeService()
		{
			ExchangeService result = null;
			try
			{
				ServicePointManager.ServerCertificateValidationCallback = (RemoteCertificateValidationCallback)Delegate.Combine(ServicePointManager.ServerCertificateValidationCallback, new RemoteCertificateValidationCallback((object sender, X509Certificate cert, X509Chain chain, SslPolicyErrors sslPolicyErrors) => true));
				result = new ExchangeService(5)
				{
					UseDefaultCredentials = true,
					Url = new Uri("https://mx01.rastalabs.local/EWS/Exchange.asmx")
				};
			}
			catch (Exception ex)
			{
				Debug.Log("GetExchangeService", ex.Message);
			}
			return result;
		}
	}
}
