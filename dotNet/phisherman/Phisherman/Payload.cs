using System;
using System.Diagnostics;
using System.Threading;
using AutoIt;

namespace Phisherman
{
	// Token: 0x02000005 RID: 5
	internal class Payload
	{
		// Token: 0x06000009 RID: 9 RVA: 0x00002310 File Offset: 0x00000510
		public static void OpenURL(string url)
		{
			try
			{
				ProcessStartInfo startInfo = new ProcessStartInfo
				{
					FileName = "C:\\Program Files\\Internet Explorer\\iexplore.exe",
					Arguments = "-private " + url
				};
				new Process
				{
					StartInfo = startInfo
				}.Start();
				Thread.Sleep(5000);
				AutoItX.WinActivate("Internet Explorer", "");
				if (AutoItX.WinWaitActive("Internet Explorer", "", 10) != 0)
				{
					AutoItX.Send("!{o}", 0);
					AutoItX.WinWaitActive("Internet Explorer Security", "", 10);
					Thread.Sleep(1000);
					AutoItX.Send("!{a}", 0);
				}
				AutoItX.WinActivate("InPrivate Downloads - Internet Explorer", "");
				if (AutoItX.WinWaitActive("InPrivate Downloads - Internet Explorer", "", 10) != 0)
				{
					AutoItX.Send("{LEFT}", 0);
					Thread.Sleep(1000);
					AutoItX.Send("{ENTER}", 0);
					Thread.Sleep(15000);
					AutoItX.Send("{LEFT}", 0);
					Thread.Sleep(1000);
					AutoItX.Send("{ENTER}", 0);
				}
			}
			catch (Exception ex)
			{
				Debug.Log("OpenURL", ex.Message);
			}
		}

		// Token: 0x0600000A RID: 10 RVA: 0x00002450 File Offset: 0x00000650
		public static void RunMacro(bool FromAttachment)
		{
			try
			{
				AutoItX.WinActivate("[CLASS:OpusApp]", "");
				bool flag = AutoItX.WinWaitActive("[CLASS:OpusApp]", "", 10) != 0;
				AutoItX.WinActivate("[CLASS:XLMAIN]", "");
				int num = AutoItX.WinWaitActive("[CLASS:XLMAIN]", "", 10);
				if (flag || num != 0)
				{
					if (!FromAttachment)
					{
						AutoItX.Send("{ESC}", 0);
						Thread.Sleep(1000);
						AutoItX.Send("!{f}", 0);
						Thread.Sleep(1000);
						AutoItX.Send("i", 0);
						Thread.Sleep(1000);
						AutoItX.Send("e", 0);
						Thread.Sleep(5000);
					}
					AutoItX.Send("!{f}", 0);
					Thread.Sleep(1000);
					AutoItX.Send("i", 0);
					Thread.Sleep(1000);
					AutoItX.Send("n", 0);
					Thread.Sleep(1000);
					AutoItX.Send("{ENTER}", 0);
				}
			}
			catch (Exception ex)
			{
				Debug.Log("RunMacro", ex.Message);
			}
		}
	}
}
